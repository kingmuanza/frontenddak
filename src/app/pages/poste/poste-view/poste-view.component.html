<div class="page">
    <div class="page-entete">
        <div *ngIf="poste.idposte!=0" class="page-entete-titre">
            Poste : {{poste.libelle}}

        </div>
        <div *ngIf="poste.idcontrat">
            Contrat : {{poste.idcontrat.libelle}}, <span *ngIf="poste.organisme">
                <b>Organisme</b>
            </span>
        </div>
        <div class="">
            <a routerLink="/poste" class="btn btn-link" style="padding: 0; margin: 0;">
                Revenir à la liste des postes
            </a>
        </div>
    </div>
    <div class="boutons">
        <div class="row">
            <div class="col-lg-2">
                <div class="nouveau">
                    <a [routerLink]="'/poste/edit/' + poste.idposte " class="btn nouveau">
                        Modifier
                    </a>
                </div>
            </div>
        </div>
    </div>
    <div class="page-contenu">
        <div class="row">
            <div class="col-lg-4">
                <div class="shadow-1" style="padding: 20px;">
                    <div>
                        <div class="infos-titre">
                            <b>
                                Informations
                            </b>
                        </div>
                        <div>
                            <div>
                                Ville : <a href="#">{{poste.zone?.idville?.libelle}}</a> , Zone : <a href="#">{{poste.zone?.libelle}}</a>, Quartier : <a href="#">{{poste.idquartier?.libelle}}</a>, Laltitude : <a href="#">{{poste.latitude}}</a>, Longitude
                                : <a href="#">{{poste.longitude}}</a>
                            </div>
                            <div>
                                Contrat : <a href="#">{{poste.contrat}}</a>, Début : {{poste.debutContrat}}
                            </div>
                            <div>
                                Personne à contacter : <a href="#">{{poste.contact}}</a>, Téléphone : {{poste.tel}}
                            </div>
                        </div>
                    </div>
                    <div>
                        <div class="infos-titre">
                            <b>
                                Exigences du contrat
                            </b>
                        </div>
                        <div>
                            <div>
                                <b>
                                    Personnel
                                </b>
                                <button *ngIf="!showFormulairePersonnel" class="btn btn-link" (click)="showFormulairePersonnel = true">
                                    Ajouter une exigence
                                </button>
                                <button *ngIf="showFormulairePersonnel" class="btn btn-link" (click)="showFormulairePersonnel = false">
                                    Annuler
                                </button>
                            </div>
                            <div *ngIf="showFormulairePersonnel">
                                <div>
                                    Nouvelle exigence du contrat
                                </div>
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">
                                            Fonction
                                        </span>
                                    </div>
                                    <select [(ngModel)]="postevigile.typeVigile" class="form-control">
                                        <option value="AGENT">Agent de sécurité</option>
                                        <option value="ESCORTEUR">Escorteur</option>
                                        <option value="CONTROLEUR">Contrôleur</option>
                                        <option value="CHAUFFEUR">Chauffeur</option>
                                        <option value="MAITRECHIEN">Maitre Chien</option>
                                        <option value="ENTRETIEN">Agent d'entretien</option>
                                        <option value="SUPERVISEUR">Superviseur</option>
                                    </select>
                                </div>
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">
                                            Horaire
                                        </span>
                                    </div>
                                    <select [(ngModel)]="postevigile.horaire" class="form-control">
                                        <option value="jour">Jour</option>
                                        <option value="nuit">Nuit</option>
                                    </select>
                                </div>
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">
                                            Nombre
                                        </span>
                                    </div>
                                    <input type="number" [(ngModel)]="postevigile.quantite" class="form-control">
                                </div>
                                <div class="input-group" style="margin-top: 20px; margin-bottom: 20px">
                                    <button (click)="ajouterExigencePersonnel()" class="btn primaire">Enregistrer</button>
                                </div>
                            </div>
                            <div>
                                <ul>
                                    <li [ngClass]="{'erreur': !verifierExigenceAgent(item)}" *ngFor="let item of postevigiles">
                                        <span>
                                            {{item.quantite}} {{item.typeVigile}} {{item.horaire}}
                                        </span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div>
                            <div>
                                <b>
                                    Equipements
                                </b>
                                <button *ngIf="!showFormulaireEquipement" class="btn btn-link" (click)="showFormulaireEquipement = true">
                                    Ajouter une exigence
                                </button>
                                <button *ngIf="showFormulaireEquipement" class="btn btn-link" (click)="showFormulaireEquipement = false">
                                    Annuler
                                </button>
                            </div>
                            <div *ngIf="showFormulaireEquipement">
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">
                                            Equipement
                                        </span>
                                    </div>
                                    <select type="text" [(ngModel)]="posteequipement.idequipement" class="form-control">
                                        <option [ngValue]="equipement" *ngFor="let equipement of equipements">
                                            {{equipement.libelle}}
                                        </option>
                                    </select>
                                </div>
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">
                                            Nombre
                                        </span>
                                    </div>
                                    <input type="number" [(ngModel)]="posteequipement.quantite" class="form-control">
                                </div>
                                <div class="input-group" style="margin-top: 20px; margin-bottom: 20px">
                                    <button (click)="ajouterExigenceEquipement()" class="btn primaire">Enregistrer</button>
                                </div>
                            </div>
                            <div>
                                <ul>
                                    <li [ngClass]="{'erreur': !verifierExigenceMateriel(item)}" *ngFor="let item of posteequipements">
                                        <span>
                                            {{item.quantite}} {{item.idequipement.libelle}}
                                        </span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-8">
                <div class="">
                    <div style="margin-bottom: 10px;">
                        Liste des vigiles titulaires en poste
                    </div>
                    <div class="row">
                        <div class="col-lg-4" *ngFor="let affectation of affectations">
                            <div>
                                Depuis le {{affectation.dateAffectation}}
                            </div>
                            <div>
                                <app-vigile [vigile]="affectation.idvigile"></app-vigile>
                            </div>
                        </div>
                    </div>
                </div>
                <div style="margin-bottom: 40px;">
                    <div style="margin-top: 20px; margin-bottom: 16px;">
                        Equipements reçus non basiques
                    </div>
                    <div *ngIf="equipementsvigiles.length === 0" style="opacity: 0.5">
                        Aucun équipement reçu
                    </div>
                    <div *ngIf="equipementsvigiles.length  > 0">
                        <ng-container *ngFor="let equipement of equipementsvigiles">
                            <ng-container *ngIf="equipement.quantite && !equipement.idequipement.basique">
                                <app-display-equipement [equipement]="equipement"></app-display-equipement>
                            </ng-container>
                        </ng-container>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>